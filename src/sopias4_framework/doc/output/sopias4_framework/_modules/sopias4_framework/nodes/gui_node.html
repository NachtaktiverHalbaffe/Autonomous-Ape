<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sopias4_framework.nodes.gui_node &mdash; Sopias4 Framework 0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/collapsible-lists/css/tree_view.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../../../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Sopias4 Framework
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">sopias4_framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../sopias4_framework.html">sopias4_framework package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sopias4_framework.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../sopias4_framework.nodes.html">sopias4_framework.nodes package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.nodes.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.nodes.html#module-sopias4_framework.nodes.gui_node">sopias4_framework.nodes.gui_node module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode"><code class="docutils literal notranslate"><span class="pre">GUINode</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.ui"><code class="docutils literal notranslate"><span class="pre">GUINode.ui</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.namespace"><code class="docutils literal notranslate"><span class="pre">GUINode.namespace</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.turtlebot_running"><code class="docutils literal notranslate"><span class="pre">GUINode.turtlebot_running</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.is_mapping"><code class="docutils literal notranslate"><span class="pre">GUINode.is_mapping</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.display_dialog_signal"><code class="docutils literal notranslate"><span class="pre">GUINode.display_dialog_signal</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.showed_dialog_signal"><code class="docutils literal notranslate"><span class="pre">GUINode.showed_dialog_signal</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.connect_callbacks"><code class="docutils literal notranslate"><span class="pre">GUINode.connect_callbacks()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.set_default_values"><code class="docutils literal notranslate"><span class="pre">GUINode.set_default_values()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.set_initial_disabled_elements"><code class="docutils literal notranslate"><span class="pre">GUINode.set_initial_disabled_elements()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.connect_labels_to_subscriptions"><code class="docutils literal notranslate"><span class="pre">GUINode.connect_labels_to_subscriptions()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.register_namespace"><code class="docutils literal notranslate"><span class="pre">GUINode.register_namespace()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.launch_robot"><code class="docutils literal notranslate"><span class="pre">GUINode.launch_robot()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.stop_robot"><code class="docutils literal notranslate"><span class="pre">GUINode.stop_robot()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.start_mapping"><code class="docutils literal notranslate"><span class="pre">GUINode.start_mapping()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.stop_mapping"><code class="docutils literal notranslate"><span class="pre">GUINode.stop_mapping()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.drive"><code class="docutils literal notranslate"><span class="pre">GUINode.drive()</span></code></a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode"><code class="docutils literal notranslate"><span class="pre">GrapficalNode</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.node_name"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.node_name</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.namespace"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.namespace</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.register_namespace"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.register_namespace()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.launch_turtlebot"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.launch_turtlebot()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.stop_turtlebot"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.stop_turtlebot()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.start_mapping"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.start_mapping()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.stop_mapping"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.stop_mapping()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.drive"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.drive()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.destroy_node"><code class="docutils literal notranslate"><span class="pre">GrapficalNode.destroy_node()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.nodes.html#module-sopias4_framework.nodes.robot_manager">sopias4_framework.nodes.robot_manager module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager"><code class="docutils literal notranslate"><span class="pre">RobotManager</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.drive_to_pos_action"><code class="docutils literal notranslate"><span class="pre">RobotManager.drive_to_pos_action</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.drive_service"><code class="docutils literal notranslate"><span class="pre">RobotManager.drive_service</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.launch_service"><code class="docutils literal notranslate"><span class="pre">RobotManager.launch_service</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.stop_service"><code class="docutils literal notranslate"><span class="pre">RobotManager.stop_service</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.start_mapping_service"><code class="docutils literal notranslate"><span class="pre">RobotManager.start_mapping_service</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.stop_mapping_service"><code class="docutils literal notranslate"><span class="pre">RobotManager.stop_mapping_service</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.RobotManager.destroy_node"><code class="docutils literal notranslate"><span class="pre">RobotManager.destroy_node()</span></code></a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.robot_manager.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.nodes.html#module-sopias4_framework.nodes">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../sopias4_framework.tools.html">sopias4_framework.tools package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.tools.html#subpackages">Subpackages</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html">sopias4_framework.tools.gui package</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#submodules">Submodules</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#module-sopias4_framework.tools.gui.gui_logger">sopias4_framework.tools.gui.gui_logger module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#sopias4_framework.tools.gui.gui_logger.GuiLogger"><code class="docutils literal notranslate"><span class="pre">GuiLogger</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#module-sopias4_framework.tools.gui.label_subscription_handle">sopias4_framework.tools.gui.label_subscription_handle module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#sopias4_framework.tools.gui.label_subscription_handle.LabelSubscriptionHandler"><code class="docutils literal notranslate"><span class="pre">LabelSubscriptionHandler</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.gui.html#module-sopias4_framework.tools.gui">Module contents</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.tools.ros2.html">sopias4_framework.tools.ros2 package</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.ros2.html#submodules">Submodules</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.ros2.html#module-sopias4_framework.tools.ros2.drive_tools">sopias4_framework.tools.ros2.drive_tools module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../sopias4_framework.tools.ros2.html#sopias4_framework.tools.ros2.drive_tools.generate_twist_msg"><code class="docutils literal notranslate"><span class="pre">generate_twist_msg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.ros2.html#module-sopias4_framework.tools.ros2">Module contents</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html">sopias4_framework.tools.scripts package</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#submodules">Submodules</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#module-sopias4_framework.tools.scripts.generate_docs">sopias4_framework.tools.scripts.generate_docs module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#sopias4_framework.tools.scripts.generate_docs.generate_docs"><code class="docutils literal notranslate"><span class="pre">generate_docs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#module-sopias4_framework.tools.scripts.generate_ui">sopias4_framework.tools.scripts.generate_ui module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#sopias4_framework.tools.scripts.generate_ui.generate_ui_object"><code class="docutils literal notranslate"><span class="pre">generate_ui_object()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.scripts.html#module-sopias4_framework.tools.scripts">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../sopias4_framework.tools.html#module-sopias4_framework.tools">Module contents</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../sopias4_framework.tools.html#tools">Tools</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../sopias4_framework.tools.html#scripts">Scripts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sopias4_framework.html#module-sopias4_framework">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Sopias4 Framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sopias4_framework.nodes.gui_node</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sopias4_framework.nodes.gui_node</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Thread</span>

<span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">Twist</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">pyqtSignal</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QMessageBox</span>
<span class="kn">from</span> <span class="nn">rclpy.client</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">rclpy.executors</span> <span class="kn">import</span> <span class="n">MultiThreadedExecutor</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">sopias4_framework.nodes.robot_manager</span> <span class="kn">import</span> <span class="n">RobotManager</span>
<span class="kn">from</span> <span class="nn">sopias4_framework.tools.ros2</span> <span class="kn">import</span> <span class="n">drive_tools</span>

<span class="kn">from</span> <span class="nn">sopias4_msgs.srv</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Drive</span><span class="p">,</span>
    <span class="n">EmptyWithStatuscode</span><span class="p">,</span>
    <span class="n">LaunchTurtlebot</span><span class="p">,</span>
    <span class="n">RegistryService</span><span class="p">,</span>
    <span class="n">ShowDialog</span><span class="p">,</span>
    <span class="n">StopMapping</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="GUINode"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode">[docs]</a><span class="k">class</span> <span class="nc">GUINode</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a Base GUI class which can be used to building a own GUI in the Sopias4 project. This class handles the QT GUI portion of the Node, the ROS2 Node itself </span>
<span class="sd">    is a class attribute (node) which is instantiated by this class and runs under the hood in another object/Thread.</span>

<span class="sd">    For generating a GUI, create a UI file with QT Designer with which you can design the GUI graphically. For this purpose, you can run `designer` in the terminal to open </span>
<span class="sd">    QT-Designer from the Dev-Container environment, otherwise you can install it on your host OS and use it there. After that, save the UI-File in the assets folder in Sopias4 </span>
<span class="sd">    Application and run the script `python3 generate_ui.py -i &lt;path to ui file&gt; -o &lt;path to directory where the generated Python class should be saved&gt;` which converts it to a </span>
<span class="sd">    Python class. The script is located in `sopias4_framework/tools/scripts` in this ROS2-package. After that, you can inherit from the GUI Node and do the necessary steps:</span>

<span class="sd">    .. highlight:: python</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">            class YourImplementationClass(GUINode):</span>

<span class="sd">                def __init__(self) -&gt;None:</span>
<span class="sd">                    # The script should name the Python object this way, but can vary. Doublecheck the class name</span>
<span class="sd">                    # within the generated Python file to be sure</span>
<span class="sd">                    self.ui: Ui_MainWindow # To enable auto-completion in IDE</span>
<span class="sd">                    ui_file = Ui_MainWindow() </span>
<span class="sd">                    super().__init(self, ui_file)</span>

<span class="sd">                def connect_callbacks(self):</span>
<span class="sd">                    # You need to overrride this method. Connect your UI elements with the callacks here.</span>
<span class="sd">                    # The ui elements are in self.ui field of the GUINode class</span>
<span class="sd">                    self.ui.example_button.clicked.connect(lambda: Thread(target=self.__foobar).start())</span>

<span class="sd">                def set_default_values(self):</span>
<span class="sd">                    # You need to override this method. Set default values or default choices of your ui elements here</span>
<span class="sd">                    self.ui.example_textbox.setText(&quot;Hello World&quot;)</span>
<span class="sd">                </span>
<span class="sd">                def set_initial_enabled_elements(self):</span>
<span class="sd">                    # Disable the desired elements here</span>
<span class="sd">                    self.ui.pushButton_example.setEnabled(False)</span>

<span class="sd">                def connect_labels_to_subscriptions(self):</span>
<span class="sd">                    # CReate and connect subscriptions here</span>
<span class="sd">                    gui_logger = GuiLogger(self.ui.textEdit)</span>
<span class="sd">                    self.node.create_subscription(Log, &quot;/rosout&quot;, gui_logger.add_log_msg, 10)</span>
<span class="sd">                    </span>
<span class="sd">                def __foobar():</span>
<span class="sd">                    print(&quot;Hello World!&quot;)</span>


<span class="sd">    Following methods needs to be overriden (look further into documentation for more details):</span>
<span class="sd">        - connect_callbacks()</span>
<span class="sd">        - set_default_values()</span>
<span class="sd">        - set_initial_enabled_elements()</span>
<span class="sd">    </span>
<span class="sd">    It also has builtin methods which you can use a callback functionas for certain tasks in Sopias4 (look further into documentation for more details):</span>
<span class="sd">        - register_namespace(): Register namespace in Sopias4 Map-Server</span>
<span class="sd">        - launch_robot(): Start all the nodes in Sopias4 Application which are interacting with the Turtlebot</span>
<span class="sd">        - stop_robot(): Stops all the nodes in Sopias4 Application which are interacting with the Turtlebot</span>

<span class="sd">    It provides following ROS2-services:</span>
<span class="sd">        - show_dialog: Show a dialog with the users. Also interaction options can be specified</span>

<span class="sd">    Attributes:</span>
<span class="sd">            ui (Ui_MainWindow()): The Python UI Object which is generated by PyQt5. Should normally be a Ui_MainWindow() instance if using the provided scripts.\</span>
<span class="sd">            node_name (str, optional): Name of the Node. Defaults to gui_node</span>
<span class="sd">            namespace (str, optional): The namespace of the node. It should not be specified by the developer. Instead the User should use the register service and \</span>
<span class="sd">                                                        let the service set the namespace of this class. Defaults to None</span>
<span class="sd">            turtlebot_running (bool): If the nodes which are interacting with the Turtlebot are running (True) or not (False). Defaults to False on startup</span>
<span class="sd">            is_mapping (bool): If the mapping process is running (True) or not (False). Defaults to False on startup</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>
    <span class="c1"># Signals for displaying dialogs because they need to be called from main thread and nodes run in a background thread</span>
    <span class="n">display_dialog_signal</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span>
    <span class="n">showed_dialog_signal</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ui</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gui_node&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># General setup</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Class attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">node_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">namespace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_mapping</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Private class attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_node</span><span class="p">:</span> <span class="n">RobotManager</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__restart_flag</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">display_dialog_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__display_dialog</span><span class="p">)</span>

        <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">:</span> <span class="n">GrapficalNode</span> <span class="o">=</span> <span class="n">GrapficalNode</span><span class="p">(</span>
            <span class="n">showed_dialog_signal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showed_dialog_signal</span><span class="p">,</span>
            <span class="n">display_dialog_signal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_dialog_signal</span><span class="p">,</span>
            <span class="n">node_name</span><span class="o">=</span><span class="n">node_name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__executor</span> <span class="o">=</span> <span class="n">MultiThreadedExecutor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__spin_node_thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__executor</span><span class="o">.</span><span class="n">spin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__spin_node_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="c1"># Setup GUI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Connecting the ui elements with callbacks and set values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_default_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_disabled_elements</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_labels_to_subscriptions</span><span class="p">()</span>

<div class="viewcode-block" id="GUINode.connect_callbacks"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.connect_callbacks">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">connect_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect the callback functions from the QT UI elements here. Needs to be overridden</span>

<span class="sd">        Example:</span>
<span class="sd">            .. highlight:: python</span>
<span class="sd">            .. code-block:: python</span>

<span class="sd">                    def connect_callbacks(self):</span>
<span class="sd">                        # The ui elements are in self.ui field of the GUINode class</span>
<span class="sd">                        self.ui.example_button.clicked.connect( lambda: Thread(target=self.hello_world).start())</span>

<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="GUINode.set_default_values"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.set_default_values">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_default_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the default values from the QT UI elements here. Needs to be overridden</span>

<span class="sd">        Example:</span>
<span class="sd">            .. highlight:: python</span>
<span class="sd">            .. code-block:: python</span>

<span class="sd">                  def set_default_values(self):</span>
<span class="sd">                    # Set default values or default choices of your ui elements here</span>
<span class="sd">                    self.ui.example_textbox.setText(&quot;Hello World&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="GUINode.set_initial_disabled_elements"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.set_initial_disabled_elements">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_initial_disabled_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets which QT elements should initially be disabled at startup. All elements which aren&#39;t disabled here are enabled by default. Needs to be overridden</span>

<span class="sd">        Example:</span>
<span class="sd">            .. highlight:: python</span>
<span class="sd">            .. code-block:: python</span>

<span class="sd">                    def set_initial_enabled_elements(self):</span>
<span class="sd">                        # Disable the desired elements here</span>
<span class="sd">                        self.ui.pushButton_example.setEnabled(False)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="GUINode.connect_labels_to_subscriptions"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.connect_labels_to_subscriptions">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">connect_labels_to_subscriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create ROS2 subscriptions which set the value of text labels</span>

<span class="sd">        Example:</span>
<span class="sd">            .. highlight:: python</span>
<span class="sd">            .. code-block:: python</span>

<span class="sd">                    def connect_labels_to_subscriptions(self):</span>
<span class="sd">                        # Create and connect subscriptions here</span>
<span class="sd">                        gui_logger = GuiLogger(self.ui.textEdit)</span>
<span class="sd">                        self.node.create_subscription(Log, &quot;/rosout&quot;, gui_logger.add_log_msg, 10)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="GUINode.register_namespace"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.register_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">register_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a namespace on the Sopias4 Map-Server. It&#39;s basically a wrapper and calling the register_namespace</span>
<span class="sd">        service client in the underlying node object. If successful, it will restart `self.node` with the namespace.</span>
<span class="sd">        This must be done before connecting to the Turtlebot.</span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>

<span class="sd">        Args:</span>
<span class="sd">            namespace (str): The namespace which should be registered</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If namespace was registered successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">register_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="n">namespace</span>
                <span class="c1"># Set restart flag so GUI recognizes the node shutdown as intentional and doesn&#39;t close</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__restart_flag</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could&#39;nt register name space: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="c1"># Set namespace of physical turtlebot</span>
        <span class="c1"># TODO send ssh command to turtlebGrot</span>
        <span class="c1"># SSH command &quot;turtlebot4-setup&quot;</span>

        <span class="c1"># Restart node with namespace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__executor</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">GrapficalNode</span><span class="p">(</span>
            <span class="n">showed_dialog_signal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showed_dialog_signal</span><span class="p">,</span>
            <span class="n">display_dialog_signal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_dialog_signal</span><span class="p">,</span>
            <span class="n">node_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">node_name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># Start robot manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_node</span> <span class="o">=</span> <span class="n">RobotManager</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__rm_node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_labels_to_subscriptions</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="GUINode.launch_robot"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.launch_robot">[docs]</a>    <span class="k">def</span> <span class="nf">launch_robot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_simulation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launches all the nodes in Sopias4 Application so the system is connected to the Turtlebot. It&#39;s basically</span>
<span class="sd">        a wrapper and calling the launcg service client in the underlying node object. Before running this, a namespace</span>
<span class="sd">        must already be registered and the gui node needs to be running under this namespace. If the operation was</span>
<span class="sd">        successful, then it sets `self.turtlebot_running` to `True`</span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">status_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">launch_turtlebot</span><span class="p">(</span><span class="n">use_simulation</span><span class="o">=</span><span class="n">use_simulation</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">status_response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Launched robot&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Could&#39;nt launch robot. Turtlebot is either already running or is&#39;nt reachable&quot;</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldnt launch robot: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="GUINode.stop_robot"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.stop_robot">[docs]</a>    <span class="k">def</span> <span class="nf">stop_robot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops all the nodes in Sopias4 Application so the system is disconnected to the Turtlebot. It&#39;s basically</span>
<span class="sd">        a wrapper and calling the launch service client in the underlying node object. If the operation was</span>
<span class="sd">        successful, then it sets `self.turtlebot_running` to `True`</span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">status_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">stop_turtlebot</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">status_response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopped robot&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Couldnt stop robot: Nodes are either already stopped or error is unknown&quot;</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldnt stop robot: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="GUINode.start_mapping"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.start_mapping">[docs]</a>    <span class="k">def</span> <span class="nf">start_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the mapping process. This can only be done if Sopias4 Application is fully running, otherwise</span>
<span class="sd">        will directly abort this process. It&#39;s basically a wrapper and calling the start_mapping service client</span>
<span class="sd">        in the underlying node object. If the operation was successful, then it sets `self.is_mapping` to `True`</span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_mapping</span><span class="p">:</span>
                <span class="n">status_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">start_mapping</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">status_response</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">is_mapping</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Started mapping&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">is_mapping</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Couldnt start mapping: Slam node couldn&#39;t be launched or unknown error occured&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Couldnt start mapping: Mapping already in process or Turtlebot is offline&quot;</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldnt start mapping: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="GUINode.stop_mapping"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.stop_mapping">[docs]</a>    <span class="k">def</span> <span class="nf">stop_mapping</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">map_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;maps/map_default&quot;</span><span class="p">,</span>
        <span class="n">map_topic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/map&quot;</span><span class="p">,</span>
        <span class="n">image_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
        <span class="n">map_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;trinary&quot;</span><span class="p">,</span>
        <span class="n">free_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.196</span><span class="p">,</span>
        <span class="n">occupied_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.65</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the mapping process. This can only be done if Sopias4 Application and the mapping process is fully running,</span>
<span class="sd">        otherwise itwill directly abort this process. It&#39;s basically a wrapper and calling the start_mapping service</span>
<span class="sd">        client in the underlying node object. If the operation was successful, then it sets `self.is_mapping` to `False`</span>

<span class="sd">        Args:</span>
<span class="sd">            map_path(str, optional): The path to the map. Can be absolute or relative to a ros package. Defaults to &quot;maps/map_default&quot;</span>
<span class="sd">            map_topic (str, optional): The topic under which the map should be served. Defaults to &quot;/map&quot;</span>
<span class="sd">            image_format (str, optional): The image format under which the visualization of the map is saved. Can be either &quot;png&quot; &quot;pgm&quot;, or &quot;bmp&quot;. Defaults to &quot;png&quot;</span>
<span class="sd">            map_mode (str, optional): Map modes: &quot;trinary&quot;, &quot;scale&quot; or &quot;raw&quot;. Defaults to &quot;trinary&quot;</span>
<span class="sd">            free_thres (float, optional): Threshold over which a region is considered as free. Defaults to 0.196</span>
<span class="sd">            occupied_thres (float, optional): Threshold over which a region is considered as occupied/obstacle. Defaults to 0.65</span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_mapping</span><span class="p">:</span>
                <span class="n">status_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">stop_mapping</span><span class="p">(</span>
                    <span class="n">image_format</span><span class="o">=</span><span class="n">image_format</span><span class="p">,</span>
                    <span class="n">map_topic</span><span class="o">=</span><span class="n">map_topic</span><span class="p">,</span>
                    <span class="n">map_path</span><span class="o">=</span><span class="n">map_path</span><span class="p">,</span>
                    <span class="n">occupied_thres</span><span class="o">=</span><span class="n">occupied_thres</span><span class="p">,</span>
                    <span class="n">free_thres</span><span class="o">=</span><span class="n">free_thres</span><span class="p">,</span>
                    <span class="n">map_mode</span><span class="o">=</span><span class="n">map_mode</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">status_response</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopped Mapping&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Couldnt stop mapping: Either SLAM node couldn&#39;t be shutdown or a unknown error occured&quot;</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Couldn&#39;t stop mapping: Mapping is already stopped or Turtlebot is offline&quot;</span>
                <span class="p">)</span>
                <span class="c1"># Inform user about failure and see for it&#39;s response</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldnt stop mapping: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="GUINode.drive"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GUINode.drive">[docs]</a>    <span class="k">def</span> <span class="nf">drive</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">twist_msg</span><span class="p">:</span> <span class="n">Twist</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">direction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span><span class="p">,</span>
        <span class="n">vel_rel</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lets the Turtlebot drive. This can only be done if Sopias4 Application is fully running, otherwise it will directly\</span>
<span class="sd">        abort this process. It&#39;s basically a wrapper and calling the sdrive service client in the underlying node object. </span>

<span class="sd">        Under normal circumstances, you use this as an callback to connect to Ui element when it is e.g. pressed</span>

<span class="sd">        Args:</span>
<span class="sd">            twist_msg (Twist, optional): The twist message which specifies how the Turtlebot should drive. If None (default), \</span>
<span class="sd">                                                            when a appropriate Twist message will be generated (Important: In this casem direction and vel_rel must be provided). </span>
<span class="sd">            direction (str, optional): The direction which the Turtlebot should drive. Can be either forward, backward, left, \</span>
<span class="sd">                                                     right, rotate_left, rotate_right and stop. Defaults to stop</span>
<span class="sd">            vel_rel (float, optional): The relative velocity. The value is normed to the maximum speed of the Turtlebot,\</span>
<span class="sd">                                                     so e.g. 1.0 is maximum speed and 0 is standing still. Defaults to 1.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turtlebot_running</span><span class="p">:</span>
                <span class="n">status_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">drive</span><span class="p">(</span><span class="n">twist_msg</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">vel_rel</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status_response</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Successfully send drive command t&gt;o Turtlebot&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Couldnt send drive command to Turtlebot du to unknown error&quot;</span>
                    <span class="p">)</span>
                    <span class="c1"># Inform user about failure and see for it&#39;s response</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Couldn&#39;t send drive command to Turtlebot: Turtlebot is offline&quot;</span>
                <span class="p">)</span>
                <span class="c1"># Inform user about failure and see for it&#39;s response</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise exception if one occurs. Only for debugging and shouldn&#39;t</span>
            <span class="c1"># appear on production if carefully tested</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldnt stop mapping: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes when the GUI is closed</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__rm_node</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
        <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__display_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_data</span><span class="p">:</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="p">()</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="c1"># Set static data that doesn&#39;t need validation</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">request_data</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">request_data</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

        <span class="c1"># Choose icon from set of QMessagebox icons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected icon: </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">icon</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">request_data</span><span class="o">.</span><span class="n">icon</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_QUESTION</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Question</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_INFO</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_WARNING</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Specified icon: </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">icon</span><span class="si">}</span><span class="s2"> isn&#39;t implemented or has wrong value. </span><span class="se">\</span>
<span class="s2">                                Implemented icons: </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_QUESTION</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_INFO</span><span class="si">}</span><span class="s2">,</span><span class="se">\</span>
<span class="s2">                                </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_WARNING</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Choose buttons which are displayed depending on the chosen interaction option in the request</span>
        <span class="c1"># The service supports the buttons which are defined as constants in the service definition (see srv/ShowDialog.srv)</span>
        <span class="c1"># PyQT support following buttons:  QMessageBox.Ok , QMessageBox.Open , QMessageBox.Save</span>
        <span class="c1"># QMessageBox.Cancel, QMessageBox.Close, QMessageBox.Yes, QMessageBox.No, QMessageBox.Abort</span>
        <span class="c1"># QMessageBox.Retry and QMessageBox.Ignore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Selected interaction options: </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">interaction_options</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">request_data</span><span class="o">.</span><span class="n">interaction_options</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_ABORT</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Abort</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_RETRY</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Retry</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_CANCEL</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">YES_NO</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">IGNORE_CANCEL</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ignore</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">IGNORE_ABORT</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Abort</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ignore</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">IGNORE_RETRY</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Retry</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ignore</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Specified interaction option: </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">interaction_options</span><span class="si">}</span><span class="s2"> has isn&#39;t implemented </span><span class="se">\</span>
<span class="s2">                        or has wrong value. Implemented icons: </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_ABORT</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                        </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_CANCEL</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_RETRY</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">YES_NO</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Showing dialog &quot;</span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="c1"># Show dialog and get the pressed button</span>
        <span class="n">selected_option</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="c1"># Here we can look for each button, even if they werent displayed,</span>
        <span class="c1"># because we only want to know the pressed button so the ones that arent displayed are not selected</span>
        <span class="k">match</span> <span class="n">selected_option</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">CONFIRMED</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Abort</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">ABORT</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Retry</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">RETRY</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">YES</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">NO</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ignore</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">IGNORE</span>
            <span class="k">case</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="n">response_data</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">CANCEL</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Dialog returned selected option: </span><span class="si">{</span><span class="n">selected_option</span><span class="si">}</span><span class="s2"> which is not</span><span class="se">\</span>
<span class="s2">                        implemented in ROS Service. Currently supported options are:</span><span class="se">\</span>
<span class="s2">                        QMessageBox.Ok, QMessageBox.Abort, QMessageBox.Retry, </span><span class="se">\</span>
<span class="s2">                        QMessageBox.Yes, QMessageBox.No, QMessageBox.Ignore and QMessageBox.Cancel&quot;</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showed_dialog_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">response_data</span><span class="p">)</span></div>


<div class="viewcode-block" id="GrapficalNode"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode">[docs]</a><span class="k">class</span> <span class="nc">GrapficalNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the ROS2 Node which runs under the hood in the GUI. To avoid problems by multiple inheritance etc, \</span>
<span class="sd">    the node is done in this separate class which is instantiated as a attribute in the GUI. As a result, this class only</span>
<span class="sd">    handles the ROS2 Node specific stuff e.b. implementing services, actions, messages etc.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        node_name (str): (optional) Name of the Node. Defaults to gui_node</span>
<span class="sd">        namespace (str): (optional) The namespace of the node. When not specified, the GUI has to register itself.\</span>
<span class="sd">                                    The namespace should not be set by the developer but instead let the register_namespace service set the namespace</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">display_dialog_signal</span><span class="p">,</span>
        <span class="n">showed_dialog_signal</span><span class="p">,</span>
        <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gui_node&quot;</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">namespace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_dialog_signal</span> <span class="o">=</span> <span class="n">display_dialog_signal</span>
        <span class="n">showed_dialog_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__set_response_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span><span class="p">:</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Log level 10 is debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">set_level</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node started with namespace </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># ---- Setup services -----</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_dialog_service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span>
            <span class="n">ShowDialog</span><span class="p">,</span> <span class="s2">&quot;show_dialog&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__show_dialog</span>
        <span class="p">)</span>

        <span class="c1"># --- Setup service clients ---</span>
        <span class="c1"># Create own sub node for service clients so they can spin independently</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="n">rclpy</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span><span class="s2">&quot;_gui_service_clients&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># This service registers the namespace in the multi robot coordinator</span>
        <span class="c1"># inside the Sopias4 Map-server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mrc_sclient_register</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
            <span class="n">RegistryService</span><span class="p">,</span> <span class="s2">&quot;/register_namespace&quot;</span>
        <span class="p">)</span>
        <span class="c1"># This service launches/connects to the corresponding Turtlebot</span>
        <span class="c1"># by launching the nodes of Sopias4 Application</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_launch</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
            <span class="n">LaunchTurtlebot</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">/launch&quot;</span>
        <span class="p">)</span>
        <span class="c1"># This service stops the running nodes of Sopias4 Application</span>
        <span class="c1"># so that the system isn&#39;t connected anymore to the physical robot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_robot</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
            <span class="n">EmptyWithStatuscode</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">/stop&quot;</span>
        <span class="p">)</span>
        <span class="c1"># This service starts the mapping process</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_start_mapping</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
                <span class="n">EmptyWithStatuscode</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">/start_mapping&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># This service stops the mapping provess</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_mapping</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
                <span class="n">StopMapping</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">/stop_mapping&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># This service sends a manual drive command to the robot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_drive</span><span class="p">:</span> <span class="n">Client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span>
            <span class="n">Drive</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_namespace</span><span class="p">()</span><span class="si">}</span><span class="s2">/drive&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GrapficalNode.register_namespace"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.register_namespace">[docs]</a>    <span class="k">def</span> <span class="nf">register_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to register the namespace in Sopias4 Map-Server.</span>
<span class="sd">        On Failure, the user is informed and has a choice to retry</span>

<span class="sd">        Args:</span>
<span class="sd">            namespace (str): The namespace which should be registered</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If namespace was registered successfully or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Sending service request to register namespace </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">request</span><span class="p">:</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Request</span> <span class="o">=</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="n">request</span><span class="o">.</span><span class="n">name_space</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mrc_sclient_register</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service request for registering namespace sent. Waiting for response&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Make sure the node itself is spinnig</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>

        <span class="n">response</span><span class="p">:</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Inform user about error</span>
            <span class="n">msg_2_user</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
            <span class="n">msg_2_user</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Error while registering namespace&quot;</span>
            <span class="n">msg_2_user</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">ICON_ERROR</span>

            <span class="k">match</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span><span class="p">:</span>
                <span class="k">case</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">COLLISION_ERROR</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Couldn&#39;t register namespace: Already registered&quot;</span>
                    <span class="p">)</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;Namespace is already registered. Choose another one&quot;</span>
                    <span class="p">)</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">interaction_options</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM</span>
                <span class="k">case</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">ILLEGAL_NAMESPACE_ERROR</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;Couldn&#39;t register namespace: Namespace contains illegal characters&quot;</span>
                    <span class="p">)</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;Namespace contains illegal characters. Choose another one&quot;</span>
                    <span class="p">)</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">interaction_options</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM</span>
                <span class="k">case</span> <span class="n">RegistryService</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">UNKNOWN_ERROR</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t register namespace: Unkown error&quot;</span><span class="p">)</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Unknown error occured&quot;</span>
                    <span class="n">msg_2_user</span><span class="o">.</span><span class="n">interaction_options</span> <span class="o">=</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">CONFIRM_RETRY</span>

            <span class="n">user_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__show_dialog</span><span class="p">(</span><span class="n">msg_2_user</span><span class="p">,</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="p">())</span>

            <span class="c1"># If user response is to retry, then recursively call this function, otherwise return False</span>
            <span class="k">if</span> <span class="n">user_response</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">==</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">CONFIRMED</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">user_response</span><span class="o">.</span><span class="n">selected_option</span> <span class="o">==</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">RETRY</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GrapficalNode.launch_turtlebot"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.launch_turtlebot">[docs]</a>    <span class="k">def</span> <span class="nf">launch_turtlebot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_simulation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to start the nodes in Sopias4 Application so the system is connected</span>
<span class="sd">        to the robot and ready for operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If operation was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sending service request to launch Turtlebot&quot;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">LaunchTurtlebot</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="n">request</span><span class="o">.</span><span class="n">use_simulation</span> <span class="o">=</span> <span class="n">use_simulation</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_launch</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Sent service request to launch Turtlebot. Waiting for response&quot;</span>
        <span class="p">)</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>

        <span class="c1"># Check response</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">LaunchTurtlebot</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">LaunchTurtlebot</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GrapficalNode.stop_turtlebot"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.stop_turtlebot">[docs]</a>    <span class="k">def</span> <span class="nf">stop_turtlebot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to stop the nodes in Sopias4 Application so the system is disconnected</span>
<span class="sd">        from the robot and ready for operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If operation was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># --- Stop the nodes ---</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Stops Turtlebot. Sending service request to stop nodes&quot;</span>
        <span class="p">)</span>
        <span class="n">stop_request</span> <span class="o">=</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_robot</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">stop_request</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service request to stop nodes sent. Waiting for response&quot;</span>
        <span class="p">)</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>

        <span class="c1"># Check response</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GrapficalNode.start_mapping"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.start_mapping">[docs]</a>    <span class="k">def</span> <span class="nf">start_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to start the mapping process. The Sopias4 Application should</span>
<span class="sd">        be fully launched before running this service</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If operation was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Send service request to start mapping&quot;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_start_mapping</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service request to start mapping sent. Waiting for response&quot;</span>
        <span class="p">)</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>

        <span class="c1"># Check response</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">EmptyWithStatuscode</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GrapficalNode.stop_mapping"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.stop_mapping">[docs]</a>    <span class="k">def</span> <span class="nf">stop_mapping</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">map_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;maps/map_default&quot;</span><span class="p">,</span>
        <span class="n">map_topic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/map&quot;</span><span class="p">,</span>
        <span class="n">image_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
        <span class="n">map_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;trinary&quot;</span><span class="p">,</span>
        <span class="n">free_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.196</span><span class="p">,</span>
        <span class="n">occupied_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.65</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to stop the mapping process. The Sopias4 Application should</span>
<span class="sd">        be fully launched and the mapping process running before running this service</span>

<span class="sd">        Args:</span>
<span class="sd">            map_name (str, optional): The path to the map. Can be absolute or relative to a ros package. Defaults to &quot;maps/map_default&quot;</span>
<span class="sd">            map_topic (str, optional): The topic under which the map should be served. Defaults to &quot;/map&quot;</span>
<span class="sd">            image_format (str, optional): The image format under which the visualization of the map is saved. Can be either &quot;png&quot; &quot;pgm&quot;, or &quot;bmp&quot;. Defaults to &quot;png&quot;</span>
<span class="sd">            map_mode (str, optional): Map modes: &quot;trinary&quot;, &quot;scale&quot; or &quot;raw&quot;. Defaults to &quot;trinary&quot;</span>
<span class="sd">            free_thres (float, optional): Threshold over which a region is considered as free. Defaults to 0.196</span>
<span class="sd">            occupied_thres (float, optional): Threshold over which a region is considered as occupied/obstacle. Defaults to 0.65</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If operation was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sending service request to stop mapping&quot;</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">StopMapping</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="n">request</span><span class="o">.</span><span class="n">map_name</span> <span class="o">=</span> <span class="n">map_path</span>
        <span class="n">request</span><span class="o">.</span><span class="n">map_topic</span> <span class="o">=</span> <span class="n">map_topic</span>
        <span class="n">request</span><span class="o">.</span><span class="n">image_format</span> <span class="o">=</span> <span class="n">image_format</span>
        <span class="n">request</span><span class="o">.</span><span class="n">map_mode</span> <span class="o">=</span> <span class="n">map_mode</span>
        <span class="n">request</span><span class="o">.</span><span class="n">free_thres</span> <span class="o">=</span> <span class="n">free_thres</span>
        <span class="n">request</span><span class="o">.</span><span class="n">occupied_thres</span> <span class="o">=</span> <span class="n">occupied_thres</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_mapping</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service request to start mapping sent. Waiting for response&quot;</span>
        <span class="p">)</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>

        <span class="c1"># Check response</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">StopMapping</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">StopMapping</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="GrapficalNode.drive"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.drive">[docs]</a>    <span class="k">def</span> <span class="nf">drive</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">twist_msg</span><span class="p">:</span> <span class="n">Twist</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">direction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span><span class="p">,</span>
        <span class="n">vel_rel</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a service client to send a driving command to the Turtlebot. The Sopias4 Application</span>
<span class="sd">        should be fully launched and the mapping process running before running this service</span>

<span class="sd">        Args:</span>
<span class="sd">            twist_msg (Twist, optional): The twist message which specifies how the Turtlebot should drive. If None (default), \</span>
<span class="sd">                                                            when a appropriate Twist message will be generated (Important: In this casem direction and vel_rel must be provided). </span>
<span class="sd">            direction (str, optional): The direction which the Turtlebot should drive. Can be either forward, backward, left, \</span>
<span class="sd">                                                     right, rotate_left, rotate_right and stop. Defaults to stop</span>
<span class="sd">            vel_rel (float, optional): The relative velocity. The value is normed to the maximum speed of the Turtlebot,\</span>
<span class="sd">                                                     so e.g. 1.0 is maximum speed and 0 is standing still. Defaults to 1.0</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: If operation was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Drive</span><span class="o">.</span><span class="n">Request</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twist_msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">twist</span> <span class="o">=</span> <span class="n">drive_tools</span><span class="o">.</span><span class="n">generate_twist_msg</span><span class="p">(</span>
                <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span> <span class="n">vel_rel</span><span class="o">=</span><span class="n">vel_rel</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">twist</span> <span class="o">=</span> <span class="n">twist_msg</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_drive</span><span class="o">.</span><span class="n">call_async</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="p">,</span> <span class="n">future</span><span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Drive</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="n">Drive</span><span class="o">.</span><span class="n">Response</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">__show_dialog</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">request_data</span><span class="p">:</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Request</span><span class="p">,</span> <span class="n">response_data</span><span class="p">:</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Callback function for the show_dialog service. It creates a QT dialog, fills it with the values from the service request and shows it.</span>
<span class="sd">        Afterwards, if specified it returns the input from the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            request_data (ShowDialog.Request): The data from the request. Look at service definition in srv/ShowDialog.srv</span>
<span class="sd">            reponse_data (ShowDialog.Response):  A response object into which the data for the response is written. Look at service definition in srv/ShowDialog.srv</span>

<span class="sd">        Returns:</span>
<span class="sd">            ShowDialog.Response: It returns response_data in which contains the selected option from the user input</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If theres invalid data in the response</span>
<span class="sd">            NotImplementedError: If the user chooses a interaction option which isn&#39;t specified in the service response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Got service request to display dialog with title </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Send Signal to main thread so dialog is shown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_dialog_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">request_data</span><span class="p">)</span>

        <span class="c1"># Wait until user responded. The feedback is returned via a QT signal which sets the self.dialog_return_data variable</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Got user response: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span><span class="o">.</span><span class="n">selected_option</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">response_data</span>

    <span class="k">def</span> <span class="nf">__set_response_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ShowDialog</span><span class="o">.</span><span class="n">Response</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_return_data</span> <span class="o">=</span> <span class="n">data</span>

<div class="viewcode-block" id="GrapficalNode.destroy_node"><a class="viewcode-back" href="../../../sopias4_framework.nodes.html#sopias4_framework.nodes.gui_node.GrapficalNode.destroy_node">[docs]</a>    <span class="k">def</span> <span class="nf">destroy_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear up tasks when the node gets destroyed by e.g. a shutdown. Mainly releasing all service and action clients</span>
<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Release service clients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_launch</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_robot</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_start_mapping</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__rm_sclient_stop_mapping</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mrc_sclient_register</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__service_client_node</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
        <span class="c1"># Release services</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_dialog_service</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Shutting down node&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Only run this node directly for testing purposes. In production this node should be extendend properly&quot;</span>
    <span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Apache-2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>